### error C2065: '...': undeclared identifier
> ...\libs\sound\sound_devices.cpp(24): error C2065: 'device_callback': undeclared identifier

```cpp=
.hpp
struct sound_devices
{
   void get_avail();
   // device_callback is declared a friend function
   friend BOOL CALLBACK device_callback(LPGUID guid, LPCWSTR description, LPCWSTR module, LPVOID context);
};

.cpp
1  void sound_devices::get_avail()
2  {
3	HRESULT res = DirectSoundEnumerateW(device_callback, this); // C2065
4	if(DS_OK != res)
5	{
6		SOUND_LOG(SOUND_ERROR, L"failed to enumerate output sound devices, " +ds_result_to_str(res));
7	}
8  }
9
10 BOOL CALLBACK device_callback(LPGUID guid, LPCWSTR description, LPCWSTR module, LPVOID context)
11 {
12 	return ... /* something */;
13 }

```
#### Description:
In line 3, `get_avail` tries to pass a pointer to the function `device_callback`. While this function is treated as `friend` in the `sound_devices` declaration in the header file, the function itself is not declared until line 10.

Previously, with `/permissive`, the Visual Studio compiler would treat the `friend` declaration in the header as a normal function declaration.

With `/permissive-` a friend declaration no longer implies a function declaration and so the function needs to be declared _before_ it is used.

See [Hidden friend name lookup rules](https://docs.microsoft.com/en-us/cpp/build/reference/permissive-standards-conformance?view=msvc-170#hidden-friend-name-lookup-rules)

#### Solution:
Add a function declaration before line 1 or move the function definition.
```cpp
1  BOOL CALLBACK device_callback(LPGUID guid, LPCWSTR description, LPCWSTR module, LPVOID context); // Function declaration added
2  void sound_devices::get_avail()
3  {
4	HRESULT res = DirectSoundEnumerateW(device_callback, this); // C2065
5	if(DS_OK != res)
6	{
7		SOUND_LOG(SOUND_ERROR, L"failed to enumerate output sound devices, " +ds_result_to_str(res));
8	}
9  }
10
11 BOOL CALLBACK device_callback(LPGUID guid, LPCWSTR description, LPCWSTR module, LPVOID context)
12 {
13 	return ... /* something */;
14 }

```
